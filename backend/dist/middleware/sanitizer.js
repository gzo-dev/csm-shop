"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.sanitize = void 0;
var sanitize = function sanitize() {
  var ignore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  return function (req, res, next) {
    var data = [];
    if (req.body) {
      data = Object.keys(req.body);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.body[data[i]] == 'string') req.body[data[i]] = req.sanitize(req.body[data[i]]).trim();
      }
    }
    if (req.params) {
      data = Object.keys(req.params);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.params[data[i]] == 'string') req.params[data[i]] = req.sanitize(req.params[data[i]]).trim();
      }
    }
    if (req.query) {
      data = Object.keys(req.query);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.query[data[i]] == 'string') req.query[data[i]] = req.sanitize(req.query[data[i]]).trim();
      }
    }
    next();
  };
};
exports.sanitize = sanitize;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzYW5pdGl6ZSIsImlnbm9yZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInJlcSIsInJlcyIsIm5leHQiLCJkYXRhIiwiYm9keSIsIk9iamVjdCIsImtleXMiLCJpIiwiaW5kZXhPZiIsInRyaW0iLCJwYXJhbXMiLCJxdWVyeSIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS9zYW5pdGl6ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNhbml0aXplID0gZnVuY3Rpb24oaWdub3JlPVtdKXtcbiAgICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAgIHZhciBkYXRhID0gW107XG4gICAgICAgIGlmKHJlcS5ib2R5KXtcbiAgICAgICAgICAgIGRhdGEgPSBPYmplY3Qua2V5cyhyZXEuYm9keSk7XG4gICAgICAgICAgICBmb3IodmFyIGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5ib2R5W2RhdGFbaV1dID09ICdzdHJpbmcnKVxuICAgICAgICAgICAgICAgICAgICByZXEuYm9keVtkYXRhW2ldXSA9IHJlcS5zYW5pdGl6ZShyZXEuYm9keVtkYXRhW2ldXSkudHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHJlcS5wYXJhbXMpe1xuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5wYXJhbXMpO1xuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgIGlmKGlnbm9yZS5pbmRleE9mKGRhdGFbaV0pID09IC0xICYmIHR5cGVvZiByZXEucGFyYW1zW2RhdGFbaV1dID09ICdzdHJpbmcnKVxuICAgICAgICAgICAgICAgICAgICByZXEucGFyYW1zW2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5wYXJhbXNbZGF0YVtpXV0pLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihyZXEucXVlcnkpe1xuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5xdWVyeSk7XG4gICAgICAgICAgICBmb3IodmFyIGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5xdWVyeVtkYXRhW2ldXSA9PSAnc3RyaW5nJylcbiAgICAgICAgICAgICAgICAgICAgcmVxLnF1ZXJ5W2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5xdWVyeVtkYXRhW2ldXSkudHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IFxuICAgICAgICBuZXh0KCk7XG4gICAgfVxufTsgIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxJQUFNQSxRQUFRLEdBQUcsU0FBWEEsUUFBUUEsQ0FBQSxFQUFzQjtFQUFBLElBQVZDLE1BQU0sR0FBQUMsU0FBQSxDQUFBQyxNQUFBLFFBQUFELFNBQUEsUUFBQUUsU0FBQSxHQUFBRixTQUFBLE1BQUMsRUFBRTtFQUN0QyxPQUFPLFVBQUNHLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUs7SUFDdkIsSUFBSUMsSUFBSSxHQUFHLEVBQUU7SUFDYixJQUFHSCxHQUFHLENBQUNJLElBQUksRUFBQztNQUNSRCxJQUFJLEdBQUdFLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDTixHQUFHLENBQUNJLElBQUksQ0FBQztNQUM1QixLQUFJLElBQUlHLENBQUMsR0FBQyxDQUFDLEVBQUNBLENBQUMsR0FBQ0osSUFBSSxDQUFDTCxNQUFNLEVBQUNTLENBQUMsRUFBRSxFQUFDO1FBQzFCLElBQUdYLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDTCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBT1AsR0FBRyxDQUFDSSxJQUFJLENBQUNELElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQ3BFUCxHQUFHLENBQUNJLElBQUksQ0FBQ0QsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxHQUFHUCxHQUFHLENBQUNMLFFBQVEsQ0FBQ0ssR0FBRyxDQUFDSSxJQUFJLENBQUNELElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxJQUFJLENBQUMsQ0FBQztNQUNsRTtJQUNKO0lBQ0EsSUFBR1QsR0FBRyxDQUFDVSxNQUFNLEVBQUM7TUFDVlAsSUFBSSxHQUFHRSxNQUFNLENBQUNDLElBQUksQ0FBQ04sR0FBRyxDQUFDVSxNQUFNLENBQUM7TUFDOUIsS0FBSSxJQUFJSCxDQUFDLEdBQUMsQ0FBQyxFQUFDQSxDQUFDLEdBQUNKLElBQUksQ0FBQ0wsTUFBTSxFQUFDUyxDQUFDLEVBQUUsRUFBQztRQUMxQixJQUFHWCxNQUFNLENBQUNZLE9BQU8sQ0FBQ0wsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLE9BQU9QLEdBQUcsQ0FBQ1UsTUFBTSxDQUFDUCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxFQUN0RVAsR0FBRyxDQUFDVSxNQUFNLENBQUNQLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsR0FBR1AsR0FBRyxDQUFDTCxRQUFRLENBQUNLLEdBQUcsQ0FBQ1UsTUFBTSxDQUFDUCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQ0UsSUFBSSxDQUFDLENBQUM7TUFDdEU7SUFDSjtJQUNBLElBQUdULEdBQUcsQ0FBQ1csS0FBSyxFQUFDO01BQ1RSLElBQUksR0FBR0UsTUFBTSxDQUFDQyxJQUFJLENBQUNOLEdBQUcsQ0FBQ1csS0FBSyxDQUFDO01BQzdCLEtBQUksSUFBSUosQ0FBQyxHQUFDLENBQUMsRUFBQ0EsQ0FBQyxHQUFDSixJQUFJLENBQUNMLE1BQU0sRUFBQ1MsQ0FBQyxFQUFFLEVBQUM7UUFDMUIsSUFBR1gsTUFBTSxDQUFDWSxPQUFPLENBQUNMLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPUCxHQUFHLENBQUNXLEtBQUssQ0FBQ1IsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsRUFDckVQLEdBQUcsQ0FBQ1csS0FBSyxDQUFDUixJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLEdBQUdQLEdBQUcsQ0FBQ0wsUUFBUSxDQUFDSyxHQUFHLENBQUNXLEtBQUssQ0FBQ1IsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNFLElBQUksQ0FBQyxDQUFDO01BQ3BFO0lBQ0o7SUFDQVAsSUFBSSxDQUFDLENBQUM7RUFDVixDQUFDO0FBQ0wsQ0FBQztBQUFDVSxPQUFBLENBQUFqQixRQUFBLEdBQUFBLFFBQUEifQ==