"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var jwt = require('jsonwebtoken');
function authenticateJWT(req, res, next) {
  var authHeader = req.header('Authorization');
  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.status(401).json({
      message: 'Missing or invalid token. Authentication failed.'
    });
  }
  var token = authHeader.substring(7);
  jwt.verify(token, process.env.JWT_SECRET, function (err, user) {
    if (err) {
      console.log(err);
      return res.status(403).json({
        message: 'Invalid token. Authentication failed.'
      });
    }
    req.user = user;
    next();
  });
}
var _default = authenticateJWT;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiYXV0aGVudGljYXRlSldUIiwicmVxIiwicmVzIiwibmV4dCIsImF1dGhIZWFkZXIiLCJoZWFkZXIiLCJzdGFydHNXaXRoIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJ0b2tlbiIsInN1YnN0cmluZyIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXJyIiwidXNlciIsImNvbnNvbGUiLCJsb2ciLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS92ZXJpZnlfdG9rZW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcblxyXG5mdW5jdGlvbiBhdXRoZW50aWNhdGVKV1QocmVxLCByZXMsIG5leHQpIHtcclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVyKCdBdXRob3JpemF0aW9uJyk7XHJcbiAgICBcclxuICAgIGlmICghYXV0aEhlYWRlciB8fCAhYXV0aEhlYWRlci5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogJ01pc3Npbmcgb3IgaW52YWxpZCB0b2tlbi4gQXV0aGVudGljYXRpb24gZmFpbGVkLicgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3Vic3RyaW5nKDcpOyBcclxuICBcclxuICAgIGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIChlcnIsIHVzZXIpID0+IHtcclxuICAgICAgaWYgKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBtZXNzYWdlOiAnSW52YWxpZCB0b2tlbi4gQXV0aGVudGljYXRpb24gZmFpbGVkLicgfSk7XHJcbiAgICAgIH1cclxuICBcclxuICAgICAgcmVxLnVzZXIgPSB1c2VyO1xyXG4gICAgICBuZXh0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbmV4cG9ydCBkZWZhdWx0IGF1dGhlbnRpY2F0ZUpXVCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsY0FBYyxDQUFDO0FBRW5DLFNBQVNDLGVBQWVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7RUFDckMsSUFBTUMsVUFBVSxHQUFHSCxHQUFHLENBQUNJLE1BQU0sQ0FBQyxlQUFlLENBQUM7RUFFOUMsSUFBSSxDQUFDRCxVQUFVLElBQUksQ0FBQ0EsVUFBVSxDQUFDRSxVQUFVLENBQUMsU0FBUyxDQUFDLEVBQUU7SUFDcEQsT0FBT0osR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUFFQyxPQUFPLEVBQUU7SUFBbUQsQ0FBQyxDQUFDO0VBQzlGO0VBRUEsSUFBTUMsS0FBSyxHQUFHTixVQUFVLENBQUNPLFNBQVMsQ0FBQyxDQUFDLENBQUM7RUFFckNiLEdBQUcsQ0FBQ2MsTUFBTSxDQUFDRixLQUFLLEVBQUVHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUUsVUFBQ0MsR0FBRyxFQUFFQyxJQUFJLEVBQUs7SUFDdkQsSUFBSUQsR0FBRyxFQUFFO01BQ1BFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSCxHQUFHLENBQUM7TUFDaEIsT0FBT2QsR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUU7TUFBd0MsQ0FBQyxDQUFDO0lBQ25GO0lBRUFSLEdBQUcsQ0FBQ2dCLElBQUksR0FBR0EsSUFBSTtJQUNmZCxJQUFJLENBQUMsQ0FBQztFQUNSLENBQUMsQ0FBQztBQUNKO0FBQUMsSUFBQWlCLFFBQUEsR0FFWXBCLGVBQWU7QUFBQXFCLE9BQUEsY0FBQUQsUUFBQSJ9